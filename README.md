# zeek_automation
Overview
This script automates the analysis of DNS logs generated by Zeek, aiming to identify potentially malicious domains, command-and-control (C2) servers, or other malware connections. By leveraging the VirusTotal API, the script checks each domain for its reputation, providing an efficient method to enhance network security and threat detection.

Functionality
Log Retrieval: The script navigates to the Zeek logs directory and fetches the DNS log file, which contains a comprehensive list of domains that have been queried.

Domain Extraction: It extracts all unique domains from the DNS log file, ensuring that each domain is processed only once, even if it appears multiple times.

VirusTotal API Integration: Using up to 16 free VirusTotal API keys, the script checks each domain against VirusTotal's extensive database to identify any malicious behavior. This rotation of API keys ensures that the script can run continuously without hitting the rate limits imposed by the VirusTotal API.

Output Files:

All Domains: The script saves a list of all domains retrieved from the DNS logs to a specified output file.
Malicious Domains: Any domains flagged as malicious by VirusTotal are saved to a separate file, providing clear visibility into potential threats.
Usage
To run the script, ensure you have access to the Zeek logs and your VirusTotal API keys configured. Execute the script, and it will generate the output files containing both the complete list of domains and the identified malicious domains.

Conclusion
This script serves as a valuable tool for network administrators and security analysts, automating the process of domain analysis and enhancing overall cybersecurity posture. By efficiently utilizing the VirusTotal API, it streamlines threat detection and response activities.
